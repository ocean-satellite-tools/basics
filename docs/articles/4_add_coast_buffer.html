<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Coastline buffer â€¢ basics</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Coastline buffer">
<meta property="og:description" content="basics">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">basics</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/1_download_data.html">Download data</a>
    </li>
    <li>
      <a href="../articles/2_add_coastline.html">Add coastline</a>
    </li>
    <li>
      <a href="../articles/3_stamen_map.html">Stamen map</a>
    </li>
    <li>
      <a href="../articles/4_add_coast_buffer.html">Coastline buffer</a>
    </li>
    <li>
      <a href="../articles/5_add_line_parallel_to_coast.html">Add lines parallel to coast</a>
    </li>
    <li>
      <a href="../articles/6_offshore_points.html">Create offshore points</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ocean-satellite-tools/basics/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="4_add_coast_buffer_files/header-attrs-2.10/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Coastline buffer</h1>
                        <h4 class="author">EE Holmes</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ocean-satellite-tools/basics/blob/master/vignettes/4_add_coast_buffer.Rmd"><code>vignettes/4_add_coast_buffer.Rmd</code></a></small>
      <div class="hidden name"><code>4_add_coast_buffer.Rmd</code></div>

    </div>

    
    
<p>This example shows how to prepare a region that is parallel to the coastline. Once this is created, you can do geometric calculations in that area, like mean Chl-a.</p>
<p>Load the sample data.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"sample_raster"</span>, package<span class="op">=</span><span class="st">"basics"</span><span class="op">)</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">sample_raster</span><span class="op">$</span><span class="va">df</span>
<span class="va">ras</span> <span class="op">&lt;-</span> <span class="va">sample_raster</span><span class="op">$</span><span class="va">raster</span>
<span class="va">lons</span> <span class="op">&lt;-</span> <span class="va">sample_raster</span><span class="op">$</span><span class="va">lons</span>
<span class="va">lats</span> <span class="op">&lt;-</span> <span class="va">sample_raster</span><span class="op">$</span><span class="va">lats</span></code></pre></div>
<p>Load the needed packages for plotting.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster">raster</a></span><span class="op">)</span></code></pre></div>
<pre><code>## Loading required package: raster</code></pre>
<pre><code>## Loading required package: sp</code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></code></pre></div>
<pre><code>## Loading required package: ggplot2</code></pre>
<div id="download-the-world-coastlines" class="section level2">
<h2 class="hasAnchor">
<a href="#download-the-world-coastlines" class="anchor"></a>Download the world coastlines</h2>
<p>For this buffer, I am using a fairly zoomed out version of the coastline. You could use the coastline from <strong>rnaturalearth</strong>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">world</span> <span class="op">&lt;-</span> <span class="fu">rnaturalearth</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rnaturalearth/man/ne_countries.html">ne_countries</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="st">"small"</span>, returnclass <span class="op">=</span> <span class="st">"sp"</span><span class="op">)</span>
<span class="va">world</span> <span class="op">&lt;-</span> <span class="fu">rgeos</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rgeos/man/topo-bin-gUnion.html">gUnaryUnion</a></span><span class="op">(</span><span class="va">world</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/crop.html">crop</a></span><span class="op">(</span><span class="va">world</span>, <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/extent.html">extent</a></span><span class="op">(</span><span class="va">lons</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">lons</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">lats</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">lats</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="4_add_coast_buffer_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
<div id="add-a-buffer-area" class="section level2">
<h2 class="hasAnchor">
<a href="#add-a-buffer-area" class="anchor"></a>Add a buffer area</h2>
<p>Here we add a buffer but it is hard to see at the world scale.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">buff1</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/buffer.html">buffer</a></span><span class="op">(</span><span class="va">world</span>, width <span class="op">=</span> <span class="fl">1</span>, dissolve <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">e</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/erase.html">erase</a></span><span class="op">(</span><span class="va">buff1</span>, <span class="va">world</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">e</span>, col<span class="op">=</span><span class="st">"red"</span>, axes<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="4_add_coast_buffer_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>Letâ€™s zoom in a bit.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/crop.html">crop</a></span><span class="op">(</span><span class="va">e</span>, <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/extent.html">extent</a></span><span class="op">(</span><span class="va">lons</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">lons</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">lats</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">lats</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"red"</span>, axes<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="4_add_coast_buffer_files/figure-html/unnamed-chunk-6-1.png" width="700"> One issue is that the units of the width are unclear. The help file for <code><a href="https://rdrr.io/pkg/raster/man/buffer.html">buffer()</a></code> says that the units are meters when <code>+proj=longlat</code> as it is for <code>world</code>, but that is clearly not the case. The help file further implies that if the object is a <code>SpatialPolygon</code>, as it is in this case, the buffer is computed using <strong>rgeos</strong>. This would imply that <code><a href="https://rdrr.io/pkg/rgeos/man/misc-gBuffer.html">rgeos::gBuffer()</a></code> is used. But the <code><a href="https://rdrr.io/pkg/rgeos/man/misc-gBuffer.html">rgeos::gBuffer()</a></code> help file has no information on the units of <code>width</code>. The distance appears to be in units of degree, and poking into the code for <code>.pointsBuffer()</code> (<a href="https://rdrr.io/cran/raster/src/R/buffer.R">here</a> by searching on google), indicates that it sets <code>longlat = FALSE</code> if the data are lines or a polygon (not points). If <code>longlat=FALSE</code> then it uses units of degree. Units of degree are quite useless since this will not be area or distance uniform as we move around the map (north to south) or as our buffer rotates (from N-S to E-W).</p>
<p>How to do this? Looking at the <code><a href="https://rdrr.io/pkg/raster/man/buffer.html">raster::buffer()</a></code> source code, it is clear that that function always uses units of degrees if the object is an <strong>sp</strong> object and not points. So letâ€™s try <code><a href="https://rdrr.io/pkg/rgeos/man/misc-gBuffer.html">rgeos::gBuffer()</a></code>. The help file is equally useless here regarding the units.</p>
<p>Hereâ€™s the workflow:</p>
<p><code>world</code> is in long-lat which is just x-y with longitude on x-axis and latitude on y-axis. Ok for plotting but in that x-y plane, 1-degree will have different kms in different places. We need to convert to a projection with meters. There are many we could use. Winkel tripel projection is a fairly standard one which is a compromise projection to preserve distance, area, and direction.</p>
<ol style="list-style-type: decimal">
<li>Define our projection string. <code>"+proj=wintri</code> means Winkel tripel projection. The <code>lon_0</code> and <code>lat_1</code> where it is centered. Letâ€™s keep at 0. <code>x_0</code> and <code>y_0</code> is the axis origin in the meters scale. We can ignore that too. <code>units</code> should be <code>m</code> or <code>km</code>.</li>
<li>Change the <code>world</code> to this projection.</li>
<li>Calculate the buffer with that. Now it will use km as the unit.</li>
<li>Get rid of the world polygon from our buffer so our buffer is just the buffer.</li>
<li>Transform our buffer back to longlat so it is easier to plot and add to our raster plots.</li>
</ol>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Step 1</span>
<span class="va">newcrs</span> <span class="op">&lt;-</span> <span class="st">"+proj=wintri +lon_0=0 +lat_1=0 +x_0=0 +y_0=0 +datum=WGS84 +units=km +no_defs"</span>
<span class="co"># Step 2</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/spTransform.html">spTransform</a></span><span class="op">(</span><span class="va">world</span>, <span class="va">newcrs</span><span class="op">)</span>
<span class="co"># Step 3</span>
<span class="va">buff1</span> <span class="op">&lt;-</span> <span class="fu">rgeos</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rgeos/man/misc-gBuffer.html">gBuffer</a></span><span class="op">(</span><span class="va">x</span>, width <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>
<span class="va">e</span><span class="op">&lt;-</span><span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/erase.html">erase</a></span><span class="op">(</span><span class="va">buff1</span>, <span class="va">x</span><span class="op">)</span></code></pre></div>
<p>Itâ€™ll be helpful to have <code>lons</code> and <code>lats</code> in these new coordinates so we can crop.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mpts</span> <span class="op">&lt;-</span> <span class="fu">SpatialPoints</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">lons</span>, <span class="va">lats</span><span class="op">)</span>, proj4string<span class="op">=</span><span class="fu">CRS</span><span class="op">(</span><span class="st">"+proj=longlat"</span><span class="op">)</span><span class="op">)</span>
<span class="va">mpts</span> <span class="op">&lt;-</span> <span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/spTransform.html">spTransform</a></span><span class="op">(</span><span class="va">mpts</span>, <span class="va">newcrs</span><span class="op">)</span></code></pre></div>
<p>Now we can plot as before:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">crop_e</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/crop.html">crop</a></span><span class="op">(</span><span class="va">e</span>, <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/extent.html">extent</a></span><span class="op">(</span><span class="va">mpts</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">crop_e</span>, col<span class="op">=</span><span class="st">"red"</span>, axes<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">x</span>, add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span></code></pre></div>
<p><img src="4_add_coast_buffer_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/spTransform.html">spTransform</a></span><span class="op">(</span><span class="va">crop_e</span>, <span class="fu"><a href="https://rdrr.io/pkg/raster/man/projection.html">crs</a></span><span class="op">(</span><span class="va">world</span><span class="op">)</span><span class="op">)</span>, axes<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">world</span>, add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span></code></pre></div>
<p><img src="4_add_coast_buffer_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
<div id="create-a-buffer-that-is-a-band-offshore" class="section level2">
<h2 class="hasAnchor">
<a href="#create-a-buffer-that-is-a-band-offshore" class="anchor"></a>Create a buffer that is a band offshore</h2>
<p>Letâ€™s create a 100km wide buffer that is 250 to 350 km offshore. 250 km is about 3 degrees longitude offshore at 40 degrees latitude (<a href="https://www.nhc.noaa.gov/gccalc.shtml">here is a calculator</a>).</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Step 1</span>
<span class="va">newcrs</span> <span class="op">&lt;-</span> <span class="st">"+proj=wintri +lon_0=0 +lat_1=0 +x_0=0 +y_0=0 +datum=WGS84 +units=km +no_defs"</span>
<span class="co"># Step 2</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/spTransform.html">spTransform</a></span><span class="op">(</span><span class="va">world</span>, <span class="va">newcrs</span><span class="op">)</span>
<span class="co"># Step 3</span>
<span class="va">buff1</span> <span class="op">&lt;-</span> <span class="fu">rgeos</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rgeos/man/misc-gBuffer.html">gBuffer</a></span><span class="op">(</span><span class="va">x</span>, width <span class="op">=</span> <span class="fl">350</span>, byid<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="va">buff2</span> <span class="op">&lt;-</span> <span class="fu">rgeos</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rgeos/man/misc-gBuffer.html">gBuffer</a></span><span class="op">(</span><span class="va">x</span>, width <span class="op">=</span> <span class="fl">250</span>, byid<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="va">e</span><span class="op">&lt;-</span><span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/erase.html">erase</a></span><span class="op">(</span><span class="va">buff1</span>, <span class="va">buff2</span><span class="op">)</span></code></pre></div>
<p>Now we can plot as before:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">e</span>, col<span class="op">=</span><span class="st">"red"</span>, axes<span class="op">=</span><span class="cn">TRUE</span>, xlim<span class="op">=</span><span class="va">mpts</span><span class="op">@</span><span class="va">bbox</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span>, ylim<span class="op">=</span><span class="va">mpts</span><span class="op">@</span><span class="va">bbox</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">x</span>, add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span></code></pre></div>
<p><img src="4_add_coast_buffer_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
</div>
<div id="add-the-sst-raster-to-this" class="section level2">
<h2 class="hasAnchor">
<a href="#add-the-sst-raster-to-this" class="anchor"></a>Add the SST raster to this</h2>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">ras</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/spTransform.html">spTransform</a></span><span class="op">(</span><span class="va">crop_e</span>, <span class="fu"><a href="https://rdrr.io/pkg/raster/man/projection.html">crs</a></span><span class="op">(</span><span class="va">world</span><span class="op">)</span><span class="op">)</span>, axes<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="st">"red"</span>, add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">world</span>, add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span></code></pre></div>
<p><img src="4_add_coast_buffer_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
</div>
<div id="create-a-line-around-the-worlds-coastlines-at-300-km-offshore" class="section level2">
<h2 class="hasAnchor">
<a href="#create-a-line-around-the-worlds-coastlines-at-300-km-offshore" class="anchor"></a>Create a line around the worldâ€™s coastlines at 300 km offshore</h2>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Step 1</span>
<span class="va">newcrs</span> <span class="op">&lt;-</span> <span class="st">"+proj=wintri +lon_0=0 +lat_1=0 +x_0=0 +y_0=0 +datum=WGS84 +units=km +no_defs"</span>
<span class="co"># Step 2</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/spTransform.html">spTransform</a></span><span class="op">(</span><span class="va">world</span>, <span class="va">newcrs</span><span class="op">)</span>
<span class="co"># Step 3</span>
<span class="va">buff1</span> <span class="op">&lt;-</span> <span class="fu">rgeos</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rgeos/man/misc-gBuffer.html">gBuffer</a></span><span class="op">(</span><span class="va">x</span>, width <span class="op">=</span> <span class="fl">300</span>, byid<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="va">e</span><span class="op">&lt;-</span><span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/erase.html">erase</a></span><span class="op">(</span><span class="va">buff1</span>, <span class="va">x</span><span class="op">)</span></code></pre></div>
<p>If we wanted to get rid of the interior coastlines, we could use the <code>remove.holes()</code> function from <strong>spatialEco</strong>.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nohole_e</span> <span class="op">&lt;-</span> <span class="fu">spatialEco</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/spatialEco/man/remove.holes.html">remove.holes</a></span><span class="op">(</span><span class="fu">spatialEco</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/spatialEco/man/remove.holes.html">remove.holes</a></span><span class="op">(</span><span class="va">e</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning in sp::proj4string(x): CRS object has comment, which is lost in output

## Warning in sp::proj4string(x): CRS object has comment, which is lost in output</code></pre>
<p>Now we can plot as before and the holes that would be removed are the red lines.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">e</span>, border<span class="op">=</span><span class="st">"red"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">nohole_e</span>, add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">x</span>, add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span></code></pre></div>
<p><img src="4_add_coast_buffer_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">e</span>, border<span class="op">=</span><span class="st">"red"</span>, axes<span class="op">=</span><span class="cn">TRUE</span>, xlim<span class="op">=</span><span class="va">mpts</span><span class="op">@</span><span class="va">bbox</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span>, ylim<span class="op">=</span><span class="va">mpts</span><span class="op">@</span><span class="va">bbox</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">x</span>, add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span></code></pre></div>
<p><img src="4_add_coast_buffer_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="http://eeholmes.github.io/">Eli Holmes</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
